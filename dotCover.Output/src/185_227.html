<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/Users/vieir4ndo/Workspace/construtora-viver-sa/src/ConstrutoraViverSA.Application/Services/MaterialService.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ConstrutoraViverSA.Domain;
using System.Collections.Generic;
using AutoMapper;
using ConstrutoraViverSA.Application.Interfaces;
using ConstrutoraViverSA.Domain.Dtos;
using ConstrutoraViverSA.Domain.Exceptions;
using ConstrutoraViverSA.Repository.Interfaces;

namespace ConstrutoraViverSA.Application.Services;

public class MaterialService : IMaterialService
{
    private readonly IMaterialRepository _repository;
    private readonly IMapper _mapper;

    public MaterialService(IMaterialRepository repository, IMapper mapper)
    {
        _repository = repository;
        _mapper = mapper;
    }

    public List&lt;MaterialDto&gt; BuscarTodos()
    {
        var materiais = _repository.BuscarTodos();

        var listaMateriaisDto = new List&lt;MaterialDto&gt;();
        
        materiais.ForEach(x =&gt; listaMateriaisDto.Add(_mapper.Map&lt;MaterialDto&gt;(x)));

        return listaMateriaisDto;
    }

    public Material BuscarEntidadePorId(long buscaId)
    {
        var material = _repository.BuscarPorId(buscaId);

        if (material is null)
        {
            throw new NaoEncontradoException(&quot;Material n&#227;o encontrado&quot;);
        }

        return material;
    }

    public MaterialDto BuscarPorId(long buscaId)
    {
        var material = BuscarEntidadePorId(buscaId);

        return _mapper.Map&lt;MaterialDto&gt;(material);
    }

    public void Adicionar(MaterialDto dto)
    {
        var material = new Material(dto.Nome, dto.Descricao, dto.Tipo, dto.Valor,
            dto.Quantidade);
        _repository.Adicionar(material);
    }

    public void Excluir(long idExcluir)
    {
        var material = BuscarEntidadePorId(idExcluir);

        _repository.Excluir(material);
    }

    public void Editar(long id, EditarMaterialDto materialAtualizado)
    {
        var material = BuscarEntidadePorId(id);

        material.SetNome(materialAtualizado.Nome);
        material.SetDescricao(materialAtualizado.Descricao);
        material.SetValor(materialAtualizado.Valor);
        material.SetTipo(materialAtualizado.Tipo);

        _repository.Editar(material);
    }

    public void MovimentarEstoque(long id, EntradaSaidaMaterialDto materialDto)
    {
        var material = BuscarEntidadePorId(id);

        material.MovimentarEstoque(materialDto.Operacao, materialDto.Quantidade);

        _repository.Editar(material);
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,5,16,75,1],[17,5,17,6,1],[18,9,18,34,1],[19,9,19,26,1],[20,5,20,6,1],[23,5,23,6,1],[24,9,24,51,1],[26,9,26,57,1],[28,9,28,32,1],[28,32,28,82,1],[28,82,28,84,1],[30,9,30,34,1],[31,5,31,6,1],[34,5,34,6,1],[35,9,35,57,1],[37,9,37,30,1],[38,9,38,10,1],[39,13,39,73,1],[42,9,42,25,1],[43,5,43,6,1],[46,5,46,6,1],[47,9,47,53,1],[49,9,49,51,1],[50,5,50,6,1],[53,5,53,6,1],[54,9,55,29,1],[56,9,56,41,1],[57,5,57,6,1],[60,5,60,6,1],[61,9,61,55,1],[63,9,63,39,1],[64,5,64,6,1],[67,5,67,6,1],[68,9,68,48,1],[70,9,70,51,1],[71,9,71,61,1],[72,9,72,53,1],[73,9,73,51,1],[75,9,75,38,1],[76,5,76,6,1],[79,5,79,6,1],[80,9,80,48,1],[82,9,82,82,1],[84,9,84,38,1],[85,5,85,6,1]]);
    </script>
  </body>
</html>