<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/Users/vieir4ndo/Workspace/construtora-viver-sa/tests/ConstrutoraViverSA.Api.Tests/Controllers/Requests/ObraRequestTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
#nullable enable
using System;
using System.Collections.Generic;
using AutoFixture;
using ConstrutoraViverSA.Api.Controllers.Requests;
using ConstrutoraViverSA.Domain.Enums;
using ConstrutoraViverSA.Domain.Exceptions;
using FluentAssertions;
using Xunit;

namespace ConstrutoraViverSA.Api.Tests.Controllers.Requests;

public class ObraRequestTests
{
    private readonly Fixture _fixture = new Fixture();
    private static readonly List&lt;long&gt; LISTA_FUNCIONARIOS_INVALIDA = new ();
    private static readonly Dictionary&lt;long, int&gt;? DICIONARIO_MATERIAIS_INVALIDO = new();

    [Fact]
    public void ValidarCricao_ComDadosValidos_DeveRetornarComoEsperado()
    {
        var request = _fixture.Build&lt;ObraRequest&gt;()
            .With(x =&gt; x.PrazoConclusao, DateTime.Today.AddDays(1))
            .Create();

        Action result = () =&gt; request.ValidarCriacao();

        result.Should().NotThrow&lt;ErroValidacaoException&gt;();
    }

    [Theory]
    [InlineData(null, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot; &quot;, null, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot; &quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, null, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, null, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot; &quot;, 10.80, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 0, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, -1, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, null, &quot;2000-10-10&quot;, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, null, 1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 0, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, -1, false, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, true, false)]
    [InlineData(&quot;nome&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;descricao&quot;, 10.80, &quot;2000-10-10&quot;, 1, false, true)]
    public void ValidarCricao_ComDadosInvalidos_DeveRetornarComoEsperado(string nome, string endereco, TipoObraEnum? tipoObra, string descricao, double? valor, string prazoConclusao, long? orcamentoId, bool comFuncionarios, bool comMateriais)
    {
        var request = new ObraRequest()
        {
            Nome = nome,
            Endereco = endereco,
            Descricao = descricao,
            TipoObra = tipoObra,
            PrazoConclusao = prazoConclusao is not null ? DateTime.Parse(prazoConclusao) : null,
            OrcamentoId = orcamentoId,
            Funcionarios = comFuncionarios ? LISTA_FUNCIONARIOS_INVALIDA : null,
            Materiais = comMateriais ? DICIONARIO_MATERIAIS_INVALIDO : null,
            Valor = valor
        };
        
        var result = () =&gt; request.ValidarCriacao();

        result.Should().Throw&lt;ErroValidacaoException&gt;();
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,5,15,55,1],[16,5,16,77,1],[17,5,17,90,1],[21,5,21,6,1],[22,9,24,23,1],[26,9,26,31,1],[26,31,26,55,1],[26,55,26,56,1],[28,9,28,60,1],[29,5,29,6,1],[47,5,47,6,1],[48,9,59,11,1],[61,9,61,28,1],[61,28,61,52,1],[61,52,61,53,1],[63,9,63,57,1],[64,5,64,6,1]]);
    </script>
  </body>
</html>