<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/Users/vieir4ndo/Workspace/construtora-viver-sa/tests/ConstrutoraViverSA.Api.Tests/Controllers/Requests/OrcamentoRequestTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using AutoFixture;
using ConstrutoraViverSA.Api.Controllers.Requests;
using ConstrutoraViverSA.Domain.Enums;
using ConstrutoraViverSA.Domain.Exceptions;
using FluentAssertions;
using Xunit;

namespace ConstrutoraViverSA.Api.Tests.Controllers.Requests;

public class OrcamentoRequestTests
{
    private readonly Fixture _fixture = new Fixture();

    [Fact]
    public void ValidarCriacao_ComDadosValidos_DeveRetornarComoEsperado()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(X =&gt; X.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var result = () =&gt; request.ValidarCriacao();

        result.Should().NotThrow&lt;ErroValidacaoException&gt;();
    }
    
    [Theory]
    [InlineData(&quot; &quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(null, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot; &quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, null, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, null, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, null, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, null, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 0)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, -1)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, null)]
    public void ValidarCriacao_ComDadosInvalidos_DeveRetornarComoEsperado(string descricao, string endereco, TipoObraEnum? tipoObra, string dataEmissao, string dataValidade, double? valor)
    {
        var request = new OrcamentoRequest()
        {
            Descricao = descricao,
            Endereco = endereco,
            TipoObra = tipoObra,
            DataEmissao = dataEmissao is not null ? DateTime.Parse(dataEmissao) : null,
            DataValidade = dataValidade is not null ? DateTime.Parse(dataValidade) : null,
            Valor = valor
        };
        
        var result = () =&gt; request.ValidarCriacao();

        result.Should().Throw&lt;ErroValidacaoException&gt;();
    }
    
    [Fact]
    public void ValidarEdicao_ComDadosValidos_DeveRetornarComoEsperado()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(X =&gt; X.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var result = () =&gt; request.ValidarEdicao();

        result.Should().NotThrow&lt;ErroValidacaoException&gt;();
    }
    
    [Theory]
    [InlineData(&quot; &quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot; &quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 10.80)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, 0)]
    [InlineData(&quot;descricao&quot;, &quot;endereco&quot;, TipoObraEnum.Ambas, &quot;2000-06-10&quot;, &quot;2000-07-12&quot;, -1)]
    public void ValidarEdicao_ComDadosInvalidos_DeveRetornarComoEsperado(string descricao, string endereco, TipoObraEnum? tipoObra, string dataEmissao, string dataValidade, double? valor)
    {
        var request = new OrcamentoRequest()
        {
            Descricao = descricao,
            Endereco = endereco,
            TipoObra = tipoObra,
            DataEmissao = dataEmissao is not null ? DateTime.Parse(dataEmissao) : null,
            DataValidade = dataValidade is not null ? DateTime.Parse(dataValidade) : null,
            Valor = valor
        };
        
        var result = () =&gt; request.ValidarEdicao();

        result.Should().Throw&lt;ErroValidacaoException&gt;();
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[13,5,13,55,1],[17,5,17,6,1],[18,9,21,23,1],[23,9,23,28,1],[23,28,23,52,1],[23,52,23,53,1],[25,9,25,60,1],[26,5,26,6,1],[40,5,40,6,1],[41,9,49,11,1],[51,9,51,28,1],[51,28,51,52,1],[51,52,51,53,1],[53,9,53,57,1],[54,5,54,6,1],[58,5,58,6,1],[59,9,62,23,1],[64,9,64,28,1],[64,28,64,51,1],[64,51,64,52,1],[66,9,66,60,1],[67,5,67,6,1],[75,5,75,6,1],[76,9,84,11,1],[86,9,86,28,1],[86,28,86,51,1],[86,51,86,52,1],[88,9,88,57,1],[89,5,89,6,1]]);
    </script>
  </body>
</html>