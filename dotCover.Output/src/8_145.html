<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/Users/vieir4ndo/Workspace/construtora-viver-sa/tests/ConstrutoraViverSA.Api.Tests/Controllers/Validators/CriarOrcamentoValidatorTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using AutoFixture;
using ConstrutoraViverSA.Api.Controllers.Requests;
using ConstrutoraViverSA.Api.Controllers.Validators;
using ConstrutoraViverSA.Domain.Enums;
using FluentAssertions;
using Xunit;

namespace ConstrutoraViverSA.Api.Tests.Controllers.Validators;

public class CriarOrcamentoValidatorTests
{
    private readonly CriarOrcamentoValidator _validator = new CriarOrcamentoValidator();
    private readonly Fixture _fixture = new Fixture();
    
    [Theory]
    [InlineData(&quot;123123&quot;)]
    [InlineData(&quot;descricao&quot;)]
    public void CriarOrcamentoValidator_DadoUmDescricaoValido_NaoDeveRetornarErros(string descricao)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Descricao, descricao)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeTrue();
    }
    
    [Theory]
    [InlineData(&quot; &quot;)]
    [InlineData(null)]
    public void CriarOrcamentoValidator_DadoUmDescricaoInvalido_DeveRetornarErros(string descricao)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Descricao, descricao)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }
    
    [Theory]
    [InlineData(&quot;Endereco&quot;)]
    [InlineData(&quot;Rua do Saber&quot;)]
    public void CriarOrcamentoValidator_DadoUmEnderecoValido_NaoDeveRetornarErros(string endereco)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Endereco, endereco)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeTrue();
    }
    
    [Theory]
    [InlineData(&quot; &quot;)]
    [InlineData(null)]
    public void CriarOrcamentoValidator_DadoUmEnderecoInvalido_DeveRetornarErros(string endereco)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Endereco, endereco)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }
    
    [Theory]
    [InlineData(TipoObraEnum.Ambas)]
    [InlineData(TipoObraEnum.Comercial)]
    [InlineData(TipoObraEnum.Residencial)]
    public void CriarOrcamentoValidator_DadoUmTipoValido_NaoDeveRetornarErros(TipoObraEnum tipoObra)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.TipoObra, tipoObra)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeTrue();
    }
    
    [Theory]
    [InlineData(1455767)]
    [InlineData(null)]
    public void CriarOrcamentoValidator_DadoUmTipoInvalido_DeveRetornarErros(int? tipoObra)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.TipoObra, tipoObra is null ? null : (TipoObraEnum)tipoObra)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }

    [Theory]
    [InlineData(10.8)]
    [InlineData(1)]
    public void CriarOrcamentoValidator_DadoUmValorValido_NaoDeveRetornarErros(double valor)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Valor, valor)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeTrue();
    }
    
    [Theory]
    [InlineData(-1)]
    [InlineData(0)]
    [InlineData(null)]
    public void CriarOrcamentoValidator_DadoUmValorInvalido_DeveRetornarErros(double? valor)
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.Valor, valor)
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }
    
    [Fact]
    public void CriarOrcamentoValidator_DadoUmaDataEmissaoEDataValidadeEmIntervaloValido_NaoDeveRetornarErros()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.DataEmissao, DateTime.Today)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeTrue();
    }
    
    [Fact]
    public void CriarOrcamentoValidator_DadoUmaDataEmissaoEDataValidadeEmIntervaloOInvalido_DeveRetornarErros()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .With(x =&gt; x.DataEmissao, DateTime.Today.AddDays(1))
            .With(x =&gt; x.DataValidade, DateTime.Today)
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }

    [Fact]
    public void CriarOrcamentoValidator_DadoUmaDataEmissaoNulla_DeveRetornarErros()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .Without(x =&gt; x.DataEmissao)
            .With(x =&gt; x.DataValidade, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }
    
    [Fact]
    public void CriarOrcamentoValidator_DadoUmaDataValidadeNulla_DeveRetornarErros()
    {
        var request = _fixture.Build&lt;OrcamentoRequest&gt;()
            .Without(x =&gt; x.DataValidade)
            .With(x =&gt; x.DataEmissao, DateTime.Today.AddDays(1))
            .Create();
        
        var validationResult = _validator.Validate(request);
        
        validationResult.IsValid.Should().BeFalse();
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[13,5,13,89,1],[14,5,14,55,1],[20,5,20,6,1],[21,9,25,23,1],[27,9,27,61,1],[29,9,29,52,1],[30,5,30,6,1],[36,5,36,6,1],[37,9,41,23,1],[43,9,43,61,1],[45,9,45,53,1],[46,5,46,6,1],[52,5,52,6,1],[53,9,57,23,1],[59,9,59,61,1],[61,9,61,52,1],[62,5,62,6,1],[68,5,68,6,1],[69,9,73,23,1],[75,9,75,61,1],[77,9,77,53,1],[78,5,78,6,1],[85,5,85,6,1],[86,9,90,23,1],[92,9,92,61,1],[94,9,94,52,1],[95,5,95,6,1],[101,5,101,6,1],[102,9,106,23,1],[108,9,108,61,1],[110,9,110,53,1],[111,5,111,6,1],[117,5,117,6,1],[118,9,122,23,1],[124,9,124,61,1],[126,9,126,52,1],[127,5,127,6,1],[134,5,134,6,1],[135,9,139,23,1],[141,9,141,61,1],[143,9,143,53,1],[144,5,144,6,1],[148,5,148,6,1],[149,9,152,23,1],[154,9,154,61,1],[156,9,156,52,1],[157,5,157,6,1],[161,5,161,6,1],[162,9,165,23,1],[167,9,167,61,1],[169,9,169,53,1],[170,5,170,6,1],[174,5,174,6,1],[175,9,178,23,1],[180,9,180,61,1],[182,9,182,53,1],[183,5,183,6,1],[187,5,187,6,1],[188,9,191,23,1],[193,9,193,61,1],[195,9,195,53,1],[196,5,196,6,1]]);
    </script>
  </body>
</html>