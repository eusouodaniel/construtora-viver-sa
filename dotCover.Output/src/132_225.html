<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/Users/vieir4ndo/Workspace/construtora-viver-sa/src/ConstrutoraViverSA.Api/Startup.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Diagnostics.CodeAnalysis;
using AutoMapper;
using ConstrutoraViverSA.Application.Interfaces;
using ConstrutoraViverSA.Application.Services;
using ConstrutoraViverSA.Infrastructure;
using ConstrutoraViverSA.Repository.Interfaces;
using ConstrutoraViverSA.Repository.Repositories;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Microsoft.OpenApi.Models;
using ConstrutoraViverSA.Api.Middlewares;
using ConstrutoraViverSA.Application.Mappers;
using Microsoft.Extensions.Logging;

namespace ConstrutoraViverSA.Api;

[ExcludeFromCodeCoverage]
public class Startup
{
    public Startup(IConfiguration configuration)
    {
        Configuration = configuration;
    }

    public IConfiguration Configuration { get; }

    // This method gets called by the runtime. Use this method to add services to the container.
    public void ConfigureServices(IServiceCollection services)
    {
        services.AddControllers().AddNewtonsoftJson(options =&gt;
            options.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore
        );

        services.AddScoped&lt;ApplicationContext&gt;();

        //Services
        services.AddScoped&lt;IMaterialService, MaterialService&gt;();
        services.AddScoped&lt;IFuncionarioService, FuncionarioService&gt;();
        services.AddScoped&lt;IObraService, ObraService&gt;();
        services.AddScoped&lt;IOrcamentoService, OrcamentoService&gt;();

        //Repositories
        services.AddScoped&lt;IFuncionarioRepository, FuncionarioRepository&gt;();
        services.AddScoped&lt;IMaterialRepository, MaterialRepository&gt;();
        services.AddScoped&lt;IObraRepository, ObraRepository&gt;();
        services.AddScoped&lt;IOrcamentoRepository, OrcamentoRepository&gt;();
        services.AddScoped&lt;IObraMaterialRepository, ObraMaterialRepository&gt;();
        
        // Mappers
        services.AddScoped&lt;IObraParaObraDto, ObraParaObraDto&gt;();
        
        // Auto Mapper Configurations
        var mapperConfig = new MapperConfiguration(mc =&gt;
        {
            mc.AddProfile(new Mappers.FuncionarioMappers());
            mc.AddProfile(new FuncionarioMappers());
            mc.AddProfile(new Mappers.MaterialMappers());
            mc.AddProfile(new MaterialMappers());
            mc.AddProfile(new Mappers.ObraMappers());
            mc.AddProfile(new ObraMappers());
            mc.AddProfile(new Mappers.OrcamentoMappers());
            mc.AddProfile(new OrcamentoMappers());            
            mc.AddProfile(new Mappers.EntradaSaidaMaterialMappers());
        });

        IMapper mapper = mapperConfig.CreateMapper();
        services.AddSingleton(mapper);


        // Register the Swagger Generator service. This service is responsible for genrating Swagger Documents.
        // Note: Add this service at the end after AddMvc() or AddMvcCore().
        services.AddSwaggerGen(c =&gt;
        {
            c.SwaggerDoc(&quot;v1&quot;, new OpenApiInfo
            {
                Title = &quot;Construtora Viver SA API&quot;,
                Version = &quot;v1&quot;,
                Description = &quot;Description for the API goes here.&quot;,
                Contact = new OpenApiContact
                {
                    Name = &quot;Matheus Vieira Santos&quot;,
                    Email = &quot;matheus.eu.mv@gmail.com&quot;,
                    Url = new Uri(&quot;https://cc.uffs.edu.br/pessoa/matheus.vieirasantos/&quot;),
                },
            });
        });
    }

    // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
    public void Configure(IApplicationBuilder app, IWebHostEnvironment env, ILoggerFactory logger)
    {
        app.UseErrorHandler(logger);

        if (env.IsDevelopment())
        {
            //app.UseDeveloperExceptionPage();
        }

        app.UseHttpsRedirection();

        app.UseRouting();

        app.UseAuthorization();

        app.UseEndpoints(endpoints =&gt; { endpoints.MapControllers(); });

        app.UseSwagger();

        // Enable middleware to serve swagger-ui (HTML, JS, CSS, etc.),
        // specifying the Swagger JSON endpoint.
        app.UseSwaggerUI(c =&gt;
        {
            c.SwaggerEndpoint(&quot;/swagger/v1/swagger.json&quot;, &quot;Construtora Viver SA API V1&quot;);

            // To serve SwaggerUI at application&#39;s root page, set the RoutePrefix property to an empty string.
            c.RoutePrefix = &quot;swagger&quot;;
        });
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,5,24,49,0],[25,5,25,6,0],[26,9,26,39,0],[27,5,27,6,0],[29,43,29,47,0],[33,5,33,6,0],[34,9,35,13,0],[35,13,35,108,0],[35,108,36,11,0],[38,9,38,50,0],[41,9,41,65,0],[42,9,42,71,0],[43,9,43,57,0],[44,9,44,67,0],[47,9,47,77,0],[48,9,48,71,0],[49,9,49,63,0],[50,9,50,73,0],[51,9,51,79,0],[54,9,54,65,0],[57,9,58,9,0],[58,9,58,10,0],[58,10,59,13,0],[59,13,59,61,0],[59,61,60,13,0],[60,13,60,53,0],[60,53,61,13,0],[61,13,61,58,0],[61,58,62,13,0],[62,13,62,50,0],[62,50,63,13,0],[63,13,63,54,0],[63,54,64,13,0],[64,13,64,46,0],[64,46,65,13,0],[65,13,65,59,0],[65,59,66,13,0],[66,13,66,51,0],[66,51,67,13,0],[67,13,67,70,0],[67,70,68,9,0],[68,9,68,10,0],[68,10,68,12,0],[70,9,70,54,0],[71,9,71,39,0],[76,9,77,9,0],[77,9,77,10,0],[77,10,78,13,0],[78,13,89,16,0],[89,16,90,9,0],[90,9,90,10,0],[90,10,90,12,0],[91,5,91,6,0],[95,5,95,6,0],[96,9,96,37,0],[98,9,98,33,0],[99,9,99,10,0],[101,9,101,10,0],[103,9,103,35,0],[105,9,105,26,0],[107,9,107,32,0],[109,9,109,39,0],[109,39,109,40,0],[109,40,109,41,0],[109,41,109,68,0],[109,68,109,69,0],[109,69,109,70,0],[109,70,109,72,0],[111,9,111,26,0],[115,9,116,9,0],[116,9,116,10,0],[116,10,117,13,0],[117,13,117,90,0],[117,90,120,13,0],[120,13,120,39,0],[120,39,121,9,0],[121,9,121,10,0],[121,10,121,12,0],[122,5,122,6,0]]);
    </script>
  </body>
</html>